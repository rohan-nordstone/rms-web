"use client"

import {
  ComponentPropsWithoutRef,
  ElementRef,
  ReactNode,
  forwardRef,
} from "react"
import Link from "next/link"
import { signOut, useSession } from "next-auth/react"

import { cn } from "@/lib/utils"
import {
  NavigationMenu,
  NavigationMenuContent,
  NavigationMenuItem,
  NavigationMenuLink,
  NavigationMenuList,
  NavigationMenuTrigger,
} from "@/components/ui/navigation-menu"
import { Separator } from "@/components/ui/separator"

type Props = {
  className?: string
  children: ReactNode
}

export function UserDropDown({ className, children }: Props) {
  const { data: session } = useSession()

  return (
    <NavigationMenu>
      <NavigationMenuList>
        <NavigationMenuItem>
          <NavigationMenuTrigger className="bg-transparent hover:bg-transparent">
            {children}
          </NavigationMenuTrigger>
          <NavigationMenuContent>
            <ul className="space-y-1 p-3">
              <Link
                className="flex max-h-11 min-w-[147px] items-center gap-[10px] rounded-[5px] px-3 py-[6px] text-base font-medium leading-[33px] text-black hover:bg-zinc-100"
                href={
                  session?.user.isEmployee
                    ? "/profile/user"
                    : "/profile/newsroom"
                }
              >
                <div className="flex h-6 w-6 items-center justify-center">
                  <svg
                    width="22"
                    height="22"
                    viewBox="0 0 22 22"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      id="Vector"
                      d="M10.503 0.90625C10.894 0.90625 11.285 0.90625 11.676 0.90625C11.7318 0.90625 11.7877 0.962108 11.8435 0.962108C13.0724 1.07382 14.2454 1.35311 15.3626 1.91169C18.4906 3.41986 20.3898 5.93347 21.0601 9.34081C21.116 9.73181 21.1718 10.1228 21.2277 10.5138C21.2277 10.9048 21.2277 11.2958 21.2277 11.6868C21.2277 11.7427 21.1718 11.7986 21.1718 11.8544C21.0601 13.0833 20.7808 14.3122 20.2222 15.3735C18.4348 18.9484 15.4743 20.9593 11.4525 21.1827C9.44165 21.2944 7.54248 20.8475 5.86674 19.7862C2.85041 17.8871 1.17467 15.0942 0.951237 11.4634C0.839521 9.62009 1.23053 7.8885 2.12425 6.26862C3.74414 3.41986 6.14603 1.68826 9.32993 1.07382C9.72094 1.01797 10.1119 0.962108 10.503 0.90625ZM11.1174 12.3013C10.503 12.2454 9.83266 12.2454 9.21822 12.2454C7.59834 12.2454 6.25774 13.3067 5.86674 14.8149C5.75502 15.3735 5.64331 15.932 6.03431 16.4348C6.25775 16.7141 6.53703 16.9375 6.81632 17.1609C8.43621 18.2781 10.1678 18.6691 12.1228 18.4457C13.5751 18.2781 14.804 17.6636 15.9212 16.7699C16.2563 16.4906 16.4239 16.0996 16.4239 15.6528C16.4239 13.977 15.1392 12.5247 13.4634 12.3571C12.7373 12.2454 11.8994 12.3013 11.1174 12.3013ZM7.76591 7.27406C7.76591 9.11737 9.27408 10.6255 11.1174 10.6255C12.9607 10.6255 14.4689 9.11737 14.4689 7.27406C14.4689 5.43075 12.9607 3.92258 11.1174 3.92258C9.27408 3.92258 7.76591 5.43075 7.76591 7.27406Z"
                      fill="black"
                    />
                  </svg>
                </div>
                My Profile
              </Link>
              <Link
                className="flex max-h-11 min-w-[147px] items-center gap-[10px] rounded-[5px] px-3 py-[6px] text-base font-medium leading-[33px] text-black hover:bg-zinc-100"
                href={
                  session?.user.isEmployee
                    ? "/profile/user_settings"
                    : "/profile/newsroom_settings"
                }
              >
                <div className="flex h-6 w-6 items-center justify-center">
                  <svg
                    width="22"
                    height="20"
                    viewBox="0 0 22 20"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <path
                      id="Vector"
                      d="M8.00438 0.148438C8.42604 0.176679 8.74649 0.357426 9.01073 0.673734C9.56731 1.34024 10.2869 1.67914 11.1583 1.6509C11.9623 1.62266 12.6145 1.27811 13.1261 0.656789C13.4072 0.317888 13.7557 0.148438 14.1943 0.176679C14.3179 0.182328 14.4472 0.216218 14.5597 0.255756C15.6391 0.65114 16.6174 1.22162 17.5 1.96156C17.9498 2.34 18.0678 2.83705 17.8654 3.43013C17.337 4.96083 18.2028 6.55366 19.7713 6.9208C19.8613 6.9434 19.9512 6.95469 20.0412 6.97729C20.5584 7.09025 20.9182 7.46869 21.0194 7.98834C21.2387 9.1519 21.2331 10.3098 21.0138 11.4734C20.9126 12.0269 20.5022 12.4279 19.94 12.5183C18.1578 12.8064 17.2077 14.4444 17.8317 16.1446C18.0397 16.7094 17.8992 17.2347 17.4326 17.6244C16.6511 18.2683 15.7965 18.7823 14.8577 19.1721C14.2505 19.4206 13.7164 19.285 13.3003 18.771C12.2434 17.455 10.3656 17.3702 9.2581 18.5903C9.16815 18.6863 9.08944 18.7993 9.01073 18.9009C8.66216 19.3415 8.12245 19.5053 7.59397 19.3076C6.49767 18.9066 5.51382 18.3361 4.62553 17.5905C4.19264 17.2234 4.0802 16.6698 4.31632 16.1107C4.63678 15.3425 4.63116 14.5856 4.25448 13.8457C3.84407 13.038 3.17505 12.5635 2.28114 12.4279C1.52217 12.315 1.16236 11.9761 1.04429 11.2192C0.870009 10.1065 0.903742 8.99939 1.11738 7.89797C1.23544 7.30489 1.64585 6.93775 2.26428 6.85867C3.66979 6.67228 4.65364 5.53131 4.5918 4.11922C4.58056 3.83681 4.50185 3.54874 4.41752 3.27762C4.21513 2.6676 4.35568 2.14795 4.86166 1.75257C5.67686 1.11995 6.56514 0.61725 7.53775 0.261404C7.68393 0.204921 7.84697 0.187976 8.00438 0.148438ZM11.0628 13.1566C12.9237 13.1566 14.4304 11.6372 14.4304 9.75627C14.4304 7.90926 12.9124 6.38986 11.074 6.38986C9.2075 6.38986 7.68955 7.89232 7.68393 9.74498C7.6783 11.6315 9.18501 13.1509 11.0628 13.1566Z"
                      fill="black"
                    />
                  </svg>
                </div>
                Settings
              </Link>
              <Separator />
              <div
                onClick={async () => {
                  signOut()
                }}
                className="flex max-h-11 min-w-[147px] cursor-pointer items-center gap-[10px] rounded-[5px] px-3 py-[6px] text-base font-medium leading-[33px] text-black hover:bg-zinc-100"
              >
                <div className="flex h-6 w-6 items-center justify-center">
                  <svg
                    width="21"
                    height="21"
                    viewBox="0 0 21 21"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                  >
                    <g id="Vector">
                      <path
                        d="M1.89821 0.728516C5.09328 0.728516 8.29221 0.728516 11.4873 0.728516C11.5374 0.740092 11.5837 0.759386 11.6339 0.767103C12.7028 0.956184 13.598 1.9093 13.6366 2.96661C13.6713 3.885 13.6482 4.80725 13.6482 5.72564C13.6482 5.96488 13.5363 6.16168 13.3511 6.30831C13.0925 6.51283 12.7993 6.55141 12.5021 6.41636C12.1934 6.27744 12.0236 6.03048 12.0198 5.68705C12.0121 4.896 12.0159 4.10495 12.0159 3.3139C12.0159 2.70807 11.6918 2.38007 11.0937 2.38007C9.95148 2.38007 8.80929 2.38007 7.66709 2.38007C7.61306 2.38007 7.55518 2.38393 7.49344 2.38779C7.50502 2.40708 7.51273 2.42252 7.52045 2.42638C8.41955 2.8084 8.72439 3.26759 8.72439 4.24772C8.72439 8.20297 8.72439 12.1582 8.72439 16.1135C8.72439 16.1945 8.72439 16.2755 8.72439 16.3681C8.82858 16.3681 8.89804 16.3681 8.96749 16.3681C9.66593 16.3681 10.3682 16.3681 11.0667 16.3681C11.7034 16.3681 12.0159 16.0517 12.0198 15.4035C12.0198 14.3886 12.0198 13.3699 12.0198 12.355C12.0198 12.247 12.0236 12.1351 12.0507 12.0309C12.1548 11.6489 12.533 11.3903 12.9112 11.4366C13.3395 11.4868 13.6482 11.8032 13.6521 12.2315C13.6598 13.3313 13.6636 14.431 13.6559 15.5308C13.6443 16.947 12.5677 18.012 11.1593 18.0158C10.4223 18.0197 9.68137 18.0158 8.94434 18.0158C8.87874 18.0158 8.80928 18.0158 8.72439 18.0158C8.72439 18.3323 8.73211 18.6217 8.72439 18.9111C8.7051 19.4243 8.49286 19.8526 8.07612 20.142C7.85617 20.2964 7.58605 20.3736 7.33523 20.4855C7.1693 20.4855 7.00338 20.4855 6.83359 20.4855C6.69853 20.443 6.56733 20.4044 6.43228 20.362C4.88105 19.8449 3.33368 19.324 1.78245 18.8069C0.910363 18.5136 0.50905 17.958 0.50905 17.0512C0.50905 12.8914 0.50905 8.73162 0.50905 4.57186C0.50905 3.83097 0.497474 3.09395 0.512909 2.35306C0.532203 1.65076 0.887211 1.15298 1.52005 0.859714C1.63967 0.801832 1.77087 0.770962 1.89821 0.728516Z"
                        fill="black"
                      />
                      <path
                        d="M20.2274 9.14065C20.0769 9.34517 19.9496 9.56897 19.7759 9.74648C18.7765 10.7652 17.7655 11.7685 16.7584 12.7795C16.5423 12.9994 16.2876 13.1191 15.9789 13.0612C15.5699 12.9879 15.3036 12.656 15.2998 12.2238C15.2959 11.4906 15.2998 10.7575 15.2998 10.0243C15.2998 9.95485 15.2998 9.88539 15.2998 9.78507C15.2149 9.78507 15.1415 9.78507 15.0682 9.78507C14.0727 9.78507 13.0771 9.78507 12.0854 9.78507C11.6262 9.78507 11.2943 9.52653 11.2133 9.12522C11.1091 8.60042 11.4873 8.14123 12.0429 8.13737C13.0501 8.13351 14.0572 8.13737 15.0644 8.13737C15.1338 8.13737 15.2033 8.13737 15.2998 8.13737C15.2998 8.06019 15.2998 7.99073 15.2998 7.92514C15.2998 7.19968 15.3036 6.47037 15.2998 5.74492C15.2959 5.35905 15.4464 5.06192 15.8053 4.91529C16.1641 4.76479 16.4805 4.86512 16.7507 5.13524C17.8157 6.20412 18.8846 7.26914 19.9457 8.34574C20.0653 8.46922 20.1348 8.64287 20.2274 8.79336C20.2274 8.90912 20.2274 9.02489 20.2274 9.14065Z"
                        fill="black"
                      />
                    </g>
                  </svg>
                </div>
                Logout
              </div>
            </ul>
          </NavigationMenuContent>
        </NavigationMenuItem>
      </NavigationMenuList>
    </NavigationMenu>
  )
}

const ListItem = forwardRef<ElementRef<"a">, ComponentPropsWithoutRef<"a">>(
  ({ className, title, children, ...props }, ref) => {
    return (
      <li>
        <NavigationMenuLink asChild>
          <a
            ref={ref}
            className={cn(
              "block select-none space-y-1 rounded-md p-3 leading-none no-underline outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground",
              className
            )}
            {...props}
          >
            <div className="text-sm font-medium leading-none">{title}</div>
            <p className="line-clamp-2 text-sm leading-snug text-muted-foreground">
              {children}
            </p>
          </a>
        </NavigationMenuLink>
      </li>
    )
  }
)
ListItem.displayName = "ListItem"
