"use client"

import "swiper/css"
import "swiper/css/pagination"
import Link from "next/link"
import { useRouter } from "next/navigation"
import { faker } from "@faker-js/faker"
import { Pagination } from "swiper/modules"
import { Swiper, SwiperSlide } from "swiper/react"

import { convertTimestamp } from "@/lib/util_functions/convertTimestamp"

import { TNews } from "../hooks/types/TNewsResponseData"

type Props = {
  recommendedNews: TNews[] | undefined
}

export default function App({ recommendedNews }: Props) {
  const router = useRouter()
  if (!recommendedNews) {
    router.refresh()
    return (
      <Swiper
        slidesPerView={1}
        pagination={{
          clickable: true,
        }}
        modules={[Pagination]}
        className="z-50 h-[400px] w-full bg-white"
      >
        <SwiperSlide>
          <div className="rounded-lg bg-white lg:flex lg:h-[510px] lg:items-center lg:justify-center">
            Loading...
          </div>
        </SwiperSlide>
      </Swiper>
    )
  }

  return (
    <Swiper
      slidesPerView={1}
      pagination={{
        clickable: true,
      }}
      modules={[Pagination]}
      // Autoplay doen't work in next.js for some reason
      // autoplay={{
      //   delay: 1000,
      //   disableOnInteraction: false,
      // }}
    >
      {recommendedNews?.map((inst, index) => (
        <SwiperSlide key={index}>
          {/* Warning Do not change the fixed height of cards  */}
          <div className="rounded-lg bg-white lg:flex lg:h-[510px]">
            <div className="aspect-h-3 aspect-w-4 flex sm:aspect-h-7 sm:aspect-w-16 lg:aspect-none">
              <img
                className="object-cover object-center"
                src={`/newsletter/carousel/image_${+faker.finance.amount({
                  min: 1,
                  max: 3,
                  dec: 0,
                })}.webp`}
                alt="Valeria-Sistrunk-Heashot"
              />
            </div>
            <div className="p-5 leading-normal lg:w-1/2 lg:p-12">
              <Link
                href={`/newsletter/details?news_id=${inst.id}`}
                className="text-2xl font-bold hover:underline lg:text-4xl"
              >
                {inst.title}
              </Link>
              <div className="my-4 flex items-center justify-between gap-5 lg:my-6">
                <div className="flex items-center gap-2 text-sm font-light text-muted-foreground">
                  <div>
                    <svg
                      width="15"
                      height="15"
                      viewBox="0 0 15 15"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <path
                        d="M14.206 7.35258C14.2135 6.19336 13.9379 5.09833 13.379 4.07883C13.3677 4.05617 13.3564 4.03351 13.3413 4.01086C12.2311 1.98317 10.1506 0.563415 7.73021 0.385945C7.69622 0.382169 7.66602 0.382169 7.63203 0.378393C7.59805 0.374617 7.56407 0.374617 7.53008 0.374617C7.50365 0.374617 7.47722 0.370841 7.44701 0.370841C7.41303 0.370841 7.37527 0.367065 7.34128 0.367065C7.29975 0.367065 7.25444 0.367065 7.2129 0.367065C7.17892 0.367065 7.14871 0.367065 7.11473 0.367065C7.09962 0.367065 7.08074 0.367065 7.06564 0.367065C7.04298 0.367065 7.02033 0.367065 6.99767 0.367065C6.98257 0.367065 6.96747 0.367065 6.94859 0.367065C6.94481 0.367065 6.94103 0.367065 6.94103 0.367065C6.90705 0.367065 6.87307 0.370841 6.83908 0.370841C5.66854 0.431257 4.57351 0.786196 3.62197 1.35636C1.58296 2.5911 0.216064 4.83402 0.216064 7.39789C0.216064 7.56025 0.21984 7.72262 0.231168 7.88499C0.374654 9.99952 1.4508 11.8611 3.04803 13.0505C3.06313 13.0618 3.07824 13.0731 3.08956 13.0807C3.24815 13.1977 3.41052 13.3073 3.58044 13.4092C3.59932 13.4205 3.61442 13.4281 3.6333 13.4394C4.65658 14.0511 5.84601 14.4098 7.1185 14.4249C7.14871 14.4249 7.17892 14.4249 7.20913 14.4249C7.23933 14.4249 7.26954 14.4249 7.29975 14.4249C7.31863 14.4249 7.34128 14.4249 7.36016 14.4249C7.38282 14.4249 7.4017 14.4249 7.42436 14.4249C7.44323 14.4249 7.45834 14.4249 7.47722 14.4249C9.48225 14.3494 11.2683 13.4243 12.4955 12.0008C12.4955 11.997 12.4992 11.997 12.503 11.9932C12.7824 11.6798 13.0316 11.3438 13.2431 10.985C13.5301 10.4979 13.7566 9.97309 13.9152 9.40669C13.919 9.38781 13.9265 9.37271 13.9303 9.35383C14.1078 8.73457 14.206 8.07756 14.206 7.39789C14.206 7.38278 14.206 7.36768 14.206 7.35258ZM12.7711 8.30789C12.7069 8.68926 12.605 9.06686 12.4615 9.44068C11.4948 11.9366 8.94606 13.3865 6.26514 12.9712C6.099 12.9448 5.93663 12.9146 5.77804 12.873C5.02285 12.6729 4.32808 12.3217 3.73525 11.8497C3.72392 11.8422 3.71637 11.8346 3.70504 11.8271C3.37276 11.5514 3.07068 11.2267 2.79126 10.8567C2.74595 10.7925 2.69309 10.7396 2.63645 10.6981C2.05118 9.88246 1.67736 8.90449 1.59806 7.84345C1.58673 7.69619 1.57918 7.54893 1.57918 7.39789C1.57918 6.85793 1.6547 6.33307 1.79441 5.83842C2.26641 4.177 3.47849 2.82521 5.04551 2.16819C6.29535 1.66222 7.7151 1.6018 8.99893 2.02848C9.01403 2.03226 9.02913 2.03981 9.04046 2.04359C9.07445 2.05492 9.10843 2.06624 9.14241 2.08135C9.44071 2.19085 9.72391 2.32301 9.99578 2.47782L10.0109 2.48537C10.0335 2.50048 10.0562 2.51181 10.0788 2.52691C10.1128 2.54579 10.1468 2.56845 10.177 2.58732C10.1921 2.59488 10.2035 2.60243 10.2148 2.61376C10.2186 2.61753 10.2223 2.61753 10.2261 2.62131C10.2223 2.62131 10.2223 2.61753 10.2186 2.61753C10.2337 2.62508 10.245 2.63641 10.2601 2.64396C10.2488 2.63641 10.2374 2.62886 10.2261 2.62131C10.2412 2.63264 10.2601 2.64396 10.2752 2.65529C10.396 2.73459 10.5131 2.81766 10.6264 2.9045C10.6075 2.8894 10.5848 2.8743 10.5659 2.85919C10.5811 2.87052 10.5962 2.88185 10.6113 2.89318C10.6226 2.90451 10.6377 2.91206 10.6528 2.92338C10.6792 2.94604 10.7057 2.96492 10.7321 2.98758C10.7547 3.00646 10.7812 3.02534 10.8038 3.04799C10.8265 3.06687 10.8454 3.08197 10.868 3.10085C10.8756 3.10463 10.8831 3.11218 10.8869 3.11973C10.9133 3.14239 10.9398 3.16505 10.9662 3.19148C10.9889 3.21413 11.0153 3.23679 11.0379 3.25944C11.053 3.27455 11.0719 3.28965 11.087 3.30853C11.1172 3.33874 11.1474 3.36517 11.1777 3.39538C11.2003 3.41803 11.223 3.44069 11.2418 3.46335C11.2645 3.486 11.2872 3.51243 11.3098 3.53509C11.3023 3.52754 11.2985 3.51999 11.2909 3.51621C11.2985 3.52376 11.306 3.53509 11.3136 3.54264C11.3136 3.54264 11.3098 3.53886 11.306 3.53886C11.3287 3.56152 11.3513 3.58795 11.374 3.61061C11.4004 3.63704 11.4231 3.66725 11.4495 3.69368C11.4911 3.74277 11.5288 3.78808 11.5704 3.83717C11.5817 3.84849 11.593 3.8636 11.6006 3.87492C11.6232 3.90513 11.6496 3.93534 11.6723 3.96555C11.6836 3.98065 11.695 3.99575 11.7101 4.01463C11.7289 4.04107 11.7516 4.0675 11.7705 4.09771C11.778 4.10903 11.7894 4.12414 11.7969 4.13547C11.8007 4.14302 11.8082 4.15057 11.812 4.15435C11.8158 4.15812 11.8158 4.1619 11.8196 4.1619C11.8384 4.18455 11.8535 4.21098 11.8724 4.23742C11.8762 4.24119 11.88 4.24874 11.8838 4.25252C11.9026 4.28273 11.9215 4.30916 11.9404 4.33937C11.9668 4.3809 11.997 4.42621 12.0197 4.46775C12.0121 4.45264 12.0008 4.43754 11.9933 4.42621C12.5294 5.29091 12.8391 6.31419 12.8391 7.40922C12.8428 7.70752 12.8202 8.01337 12.7711 8.30789ZM10.3318 9.5464C10.3734 9.83715 10.2563 10.0864 10.0184 10.2299C9.90516 10.2978 9.78432 10.3356 9.66349 10.3356C9.52001 10.3356 9.3803 10.2865 9.25192 10.1921C9.0027 10.0071 8.75727 9.82205 8.50805 9.63325C8.391 9.5464 8.27394 9.45578 8.15311 9.36893C8.01718 9.26698 7.87747 9.16126 7.74154 9.05931C7.37527 8.78366 6.9939 8.49669 6.6163 8.22105C6.40107 8.06245 6.29157 7.84723 6.29157 7.58291C6.29157 6.81639 6.29157 6.0461 6.29157 5.27958V5.1512C6.29157 4.63011 6.29157 4.10903 6.29157 3.58795C6.29157 3.38405 6.36331 3.19525 6.49925 3.06309C6.62385 2.93849 6.79 2.8743 6.97124 2.8743H6.97502C7.36394 2.87807 7.64714 3.18015 7.65091 3.5955C7.65091 4.02219 7.65091 4.44887 7.65091 4.87555V5.43439C7.65091 5.58543 7.65091 5.73647 7.65091 5.88751V5.89506C7.65091 6.3444 7.65091 6.81261 7.64714 7.26951C7.64714 7.27706 7.64714 7.28083 7.64714 7.28461C7.65091 7.28461 7.65469 7.29216 7.66224 7.29594C8.12668 7.64332 8.59112 7.99449 9.05179 8.34565L9.14997 8.41739C9.43694 8.63262 9.72013 8.85163 10.0071 9.06686C10.1393 9.16126 10.2979 9.30852 10.3318 9.5464ZM10.498 2.80255C10.5055 2.80633 10.5093 2.81011 10.5169 2.81766C10.498 2.80255 10.4791 2.78745 10.4564 2.77612C10.4715 2.78367 10.4829 2.79123 10.498 2.80255Z"
                        fill="#828282"
                      />
                    </svg>
                  </div>
                  <p>{convertTimestamp(new Date(inst.createdAt))}</p>
                </div>
                <p className="text-sm font-light text-muted-foreground">
                  Written by{" "}
                  <span className="font-semibold text-secondary">
                    {inst.author.name}
                  </span>
                </p>
              </div>
              <p className="line-clamp-[10] text-base font-light">
                {inst.content}
              </p>
            </div>
          </div>
        </SwiperSlide>
      ))}
    </Swiper>
  )
}
